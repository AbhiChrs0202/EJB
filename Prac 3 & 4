3a. Create a Servlet application to upload and download a file.
~~~~~~~~~~~~~~~~~~~ index.html ~~~~~~~~~~~~~~~~~~~~~~
<html>
 <body>
 <form action="FileUploadServlet" method="post" enctype="multipart/form-data">
 Select File to Upload:<input type="file" name="file" id="file">
 Destination <input type="text" value="/tmp" name="destination">
 <br>
 <input type="submit" value="Upload file" name="upload" id="upload">
 </form>
 </body>
</html>
~~~~~ FileUploadServlet.java ~~~~~~~
package fileservletapp;
import java.io.*;
import javax.servlet.*;
import javax.servlet.annotation.MultipartConfig;
import javax.servlet.http.*;
@MultipartConfig
public class FileUploadServlet extends HttpServlet {
public void doPost(HttpServletRequest req,HttpServletResponse res) throws ServletException,
IOException
{
 res.setContentType("text/html");
 PrintWriter out = res.getWriter();
 String path=req.getParameter("destination");
 Part filePart=req.getPart("file");
 String filename=filePart.getSubmittedFileName().toString();
 out.print("<br><br><hr> file name: "+filename);
 OutputStream os=null;
 InputStream is=null;
try {
 os=new FileOutputStream(new File(path+File.separator+filename));
 is=filePart.getInputStream();
 int read=0;

 while ((read = is.read()) != -1) {
 os.write(read);
 }
 out.println("<br>file uploaded sucessfully...!!!");
 }
 catch(FileNotFoundException e){out.print(e);}
} }
~~~~~ index.html ~~~~~~
<html>
 <head>
 <title>File Download Page</title>
 </head>
 <body>
 <h1>File Download Application</h1>
 Click <a href="DownloadServlet?filename=SampleChapter.pdf">Sample Chapter</a>
 <br/><br/>
 Click <a href="DownloadServlet?filename=TOC.pdf">Table Of Contents</a>
 </body>
</html>
~~~~~ DownloadServlet.java ~~~~~~
package filedownloadapp;
import java.io.IOException;
import java.io.InputStream;
import java.io.PrintWriter;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
public class DownloadServlet extends HttpServlet {
public void doGet(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException {
 response.setContentType("APPLICATION/OCTET-STREAM");
 String filename = request.getParameter("filename");
 ServletContext context = getServletContext();
InputStream is = context.getResourceAsStream("/" + filename);
 //ServletOutputStream out = response.getOutputStream(); // any of the two works
 PrintWriter out=response.getWriter();
 response.setHeader("Content-Disposition","attachment; filename=\"" + filename + "\""); //
if comment this statement then it wl ask you about the editor with which you want to open the file
 int i;

 while ((i=is.read()) != -1) {
 out.write(i);
 }
 is.close();
 out.close();
}
}


3b. Develop Simple Servlet Question Answer Application using Database.
create database qadb;
use qabd;
create table quiz (qno varchar(5) PRIMARY KEY,question varchar(100), op1 varchar(50), op2
varchar(50), op3 varchar(50), op4 varchar(50), ans varchar(50))
insert into quiz values('001','What is the capital of India??','New
Delhi','Kolkata','Chennai','Mumbai','New Delhi');
insert into quiz values('002','Who was the First President of India??','Dr. Rajendra Prasad','Dr. S.
Radhakrishnan','Ram Nath Kovind','V. V. Giri','Dr. Rajendra Prasad');
insert into quiz values('003','What is ORM','Object Ratio Mean','Object Rotation Measure','Object
Relation Mapping','Oracle Request Management','Object Relation Mapping');
insert into quiz values('004','Unit of Energy is ___','Dozon','Kilo Meter ','Joul','Hertz','Joul')
insert into quiz values('005',' --- is the smallest memory unit.','bit','byte','Kilo Byte','Giga Byte','bit')
index.html
<html><head><title>Quiz Application</title></head>
<body>
<h1>Welcome to Quiz Servlet </h1>
<h1><a href="QuizServlet" >CLICK TO START QUIZ</a></h1>
</body>
</html>
QuizServlet.java
package mypack;
import java.io.*;
import java.sql.*;
import javax.servlet.*;
import javax.servlet.http.*;
public class QuizServlet extends HttpServlet {
public void doGet(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException {
 response.setContentType("text/html;charset=UTF-8");
 PrintWriter out = response.getWriter();
out.println("<form action=ShowResult >");
 try {
 Class.forName("com.mysql.jdbc.Driver");
 Connection con =
DriverManager.getConnection("jdbc:mysql://localhost:3306/qadb","root","root");
Statement stmt = con.createStatement();
ResultSet res = stmt.executeQuery("select * from quiz");
out.println("<table border=1 >");
int qno=0;
while(res.next()){
 qno++;
out.println("<tr><td>"+res.getString(1)+"</td>");
out.println("<td>"+res.getString(2)+"</td></tr>");
out.println("<tr><td><input type=radio name="+qno+"
value="+res.getString(3)+"></td><td>"+res.getString(3)+"</td></tr>");
out.println("<tr><td><input type=radio name="+qno+"
value="+res.getString(4)+"></td><td>"+res.getString(4)+"</td></tr>");
out.println("<tr><td><input type=radio name="+qno+"
value="+res.getString(5)+"></td><td>"+res.getString(5)+"</td></tr>");
out.println("<tr><td><input type=radio name="+qno+"
value="+res.getString(6)+"></td><td>"+res.getString(6)+"</td></tr>");
}
 }catch(Exception e){out.println(e);}
out.println("</table>");
out.println("<input type=reset >");
 out.println("<input type=submit value=SUBMIT >");
 out.println("</form>"); } }


3c. Create simple Servlet application to demonstrate Non-Blocking Read Operation.
<html>
<head>
<title>Non Blocking IO</title>
<meta charset="UTF-8">
<meta http-equiv="Refresh" content="0; URL=NonBlockingServlet">
</head>
<body>
</body>
</html>
----------------------------------------------- NonBlockingServlrt.java ---------------------
package nonblkapp;
import java.io.*;
import java.net.*;
import javax.servlet.*;
import javax.servlet.http.*;
public class NonBlockingServlet extends HttpServlet {
 protected void service(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException {
 response.setContentType("text/html;charset=UTF-8");
 try (PrintWriter out = response.getWriter()) {

 out.println("<h1>FileReader</h1>");
 String filename="/WEB-INF/booklist.txt";
 ServletContext c=getServletContext();
 InputStream in=c.getResourceAsStream(filename);
 String
path="http://"+request.getServerName()+":"+request.getServerPort()+request.getContextPath()+"/Rea
dingNonBloclingServlet";
 URL url=new URL(path);
 HttpURLConnection conn=(HttpURLConnection)url.openConnection();
 conn.setChunkedStreamingMode(2);
 conn.setDoOutput(true);
 conn.connect();
 if(in!=null)
 {
 InputStreamReader inr=new InputStreamReader(in);
 BufferedReader br = new BufferedReader(inr);
 String text="";
 System.out.println("Reading started....");
 BufferedWriter bw=new BufferedWriter(new
OutputStreamWriter(conn.getOutputStream()));
 while((text=br.readLine())!=null){
 out.print(text+"<br>");
try{
 Thread.sleep(1000);
 out.flush();
 }
 catch(InterruptedException ex){}
}out.print("reading completed....");
 bw.flush();
 bw.close();
 }
 }
 }
}
------------------------------------- ReadingListener.java -----------------------------
package nonblkapp;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.servlet.AsyncContext;
import javax.servlet.ReadListener;
import javax.servlet.ServletInputStream;
public class ReadingListener implements ReadListener
{
 private ServletInputStream input = null;
 private AsyncContext ac = null;
 ReadingListener(ServletInputStream in, AsyncContext c) {
 input = in;
 ac = c;
 }
 @Override
 public void onDataAvailable() throws IOException {
 }
 public void onAllDataRead() throws IOException {
 ac.complete();
 }
 public void onError(final Throwable t) {
 ac.complete();
 t.printStackTrace();
 }
}
---------------------------------- ReadingNonBlockingServlet.java --------------------------------
package nonblkapp;
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.AsyncContext;
import javax.servlet.ServletException;
import javax.servlet.ServletInputStream;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
/**
*
* @author Beena
*/
@WebServlet (name = "ReadingNonBlockingServlet", urlPatterns =
{"/ReadingNonBlockingServlet"},asyncSupported = true )
public class ReadingNonBlockingServlet extends HttpServlet {
@Override
 protected void service(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException {
 response.setContentType("text/html");
 AsyncContext ac = request.startAsync();
 ServletInputStream in=request.getInputStream();
 in.setReadListener(new ReadingListener(in,ac));
 }
} 


4a. Develop a simple JSP application to display values obtained from the use of intrinsic objects of
various types.
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<html><head><title>JSP Page</title></head>
<body>
<h1>Use of Intrinsic Objects in JSP</h1>
<h1>Request Object </h1>
 Query String <%=request.getQueryString() %><br>
 Context Path <%=request.getContextPath() %><br>
 Remote Host <%=request.getRemoteHost() %><br>
<h1>Response Object </h1>
 Character Encoding Type <%=response.getCharacterEncoding() %><br>
 Content Type <%=response.getContentType() %><br>
 Locale <%=response.getLocale() %><br>
<h1>Session Object </h1>
 ID <%=session.getId() %><br>
 Creation Time <%=new java.util.Date(session.getCreationTime()) %><br>
 Last Access Time<%=new java.util.Date(session.getLastAccessedTime()) %><br>
</body>
</html>

4b. Develop a simple JSP application to pass values from one page to another with validations.
(Name-txt, age-txt, hobbies-checkbox, email-txt, gender-radio button).
index.html
<html><head><title>User Information Paage</title>
</head>
<body>
<form action="Validate.jsp">
 Enter Your Name<input type="text" name="name" ><br>
 Enter Your Age<input type="text" name="age" ><br>
 Select Hobbies
<input type="checkbox" name="hob" value="Singing">Singing
<input type="checkbox" name="hob" value="Reading">Reading Books
<input type="checkbox" name="hob" value="Football">Playing Football<br>
 Enter E-mail<input type="text" name="email" ><br>
 Select Gender
<input type="radio" name="gender" value="male">Male
<input type="radio" name="gender" value="female">Female
<input type="radio" name="gender" value="other">Other<br>
<input type="hidden" name="error" value="">
<input type="submit" value="Submit Form">
</form>
</body>
</html>
------------------------------------------ Validate.jsp----------------------------------------------------
<%@page contentType="text/html" pageEncoding="UTF-8" import="mypack.*" %>
<html><head><title>JSP Page</title></head>
<body>
<h1>Validation Page</h1>
<jsp:useBean id="obj" scope="request"
 class="mypack.CheckerBean" >
<jsp:setProperty name="obj" property="*"/>
</jsp:useBean>
<%if (obj.validate())
{ %>
<jsp:forward page="successful.jsp"/>
<% }
else {%>
<jsp:include page="index.html"/>
<%}%>
<%=obj.getError() %>
</body></html>
----------------------------------------CheckerBean.java-------------------------------------------
package mypack;
public class CheckerBean {
private String name, age, hob, email, gender, error;
public CheckerBean(){error="";}
public void setName(String n){name=n;}
public void setAge(String a){age=a;}
public void setHob(String h){hob=h;}
public void setEmail(String e){email=e;}
public void setGender(String g){gender=g;}
public void setError(String e){error=e;}
public String getName(){return name;}
public String getAge(){return age;}
public String getHob(){return hob;}
public String getEmail(){return email;}
public String getGender(){return gender;}
public String getError(){return error;}
public boolean validate(){
boolean res=true;
if(name.trim().equals("")) {error+="<br>Enter First Name";res=false;}
if(age.length() > 2 )
{error+="<br>Age Invalid";res=false;}
return res;
}
}
---------------------------------------------- ShowResult.java--------------------------------
package mypack;
import java.io.*;
import java.sql.*;
import javax.servlet.*;
import javax.servlet.http.*;
public class ShowResult extends HttpServlet {
public void doGet(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException {
 response.setContentType("text/html;charset=UTF-8");
 PrintWriter out = response.getWriter();
 try {
 Class.forName("com.mysql.jdbc.Driver");
 Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/qadb","root","root");
Statement stmt = con.createStatement();
ResultSet res = stmt.executeQuery("select ans from quiz");
int count =0, qno=0;
while(res.next()){
 if(res.getString(1).equals(request.getParameter(""+(++qno))))
 { count++;
 out.println("<h1>Correct </h1>");
 }
 else {
 out.println("<h1>Incorrect </h1>");
 }
}
out.println("<h1>Your Score is "+count+" </h1>");
 }catch(Exception e){out.println(e);}}} 


4c. Create a registration and login JSP application to register and authenticate the user based on
username and password using JDBC.
--------------------------------------Register.html--------------------------------------
<html><head><title>New User Registration Page</title></head>
<body>
<form action="Register.jsp" >
<h1> New User Registration Page</h1>
 Enter User Name <input type="text" name="txtName" ><br>
 Enter Password <input type="password" name="txtPass1" ><br>
 Re-Enter Password<input type="password" name="txtPass2" ><br>
 Enter Email<input type="text" name="txtEmail" ><br>
 Enter Country Name <input type="text" name="txtCon" ><br>
<input type="reset" ><input type="submit" value="REGISTER" >
</form>
</body>
</html>
----------------------------------------Register.jsp-------------------------------------------
<%@page contentType="text/html" import="java.sql.*"%>
<html><body>
<h1>Registration JSP Page</h1>
<%
 String uname=request.getParameter("txtName");
 String pass1 = request.getParameter("txtPass1");
 String pass2 = request.getParameter("txtPass2");
 String email = request.getParameter("txtEmail");
 String ctry = request.getParameter("txtCon");
 if(pass1.equals(pass2)){
 try{
 Class.forName("com.mysql.jdbc.Driver");
 Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/logindb");
 PreparedStatement stmt = con.prepareStatement("insert into user values (?,?,?,?)");
 stmt.setString(1, uname); stmt.setString(2, pass1);
 stmt.setString(3, email); stmt.setString(4, ctry);
 int row = stmt.executeUpdate();
 if(row==1) { out.println("Registration Successful"); }
 else {
 out.println("Registration FFFFFAAAIIILLLL !!!!");
 %><jsp:include page="Register.html" ></jsp:include>
<%
 }
 }catch(Exception e){out.println(e);}
 }
 else
 {
 out.println("<h1>Password Mismatch</h1>");
 %>
<jsp:include page="Register.html" ></jsp:include>
<% }
 %>
</body>
</html>
------------------- Login.html -----------------------------------
<html>
<body>
<h1>Login Page</h1>
<form action="Login.jsp" >
 Enter User Name <input type="text" name="txtName" ><br>
 Enter Password <input type="password" name="txtPass" ><br>
<input type="reset" ><input type="submit" value="~~~LOGIN~~" >
</form>
</body>
</html>
------------------- Login.jsp----------------------------------
<%@page contentType="text/html" import="java.sql.*"%>
<html><body>
<h1>Registration JSP Page</h1>
<%
 String uname=request.getParameter("txtName");
 String pass = request.getParameter("txtPass");
 try{
 Class.forName("com.mysql.jdbc.Driver");
 Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/logindb");
 PreparedStatement stmt = con.prepareStatement("select password from user where username=?");
 stmt.setString(1, uname);
 ResultSet rs = stmt.executeQuery();
 if(rs.next()){
 if(pass.equals(rs.getString(1)))
 {
 out.println("<h1>~~~ LOGIN SUCCESSFULLL ~~~ </h1>");
 }
 }
 else{
 out.println("<h1>User Name not exist !!!!!</h1>");
 %>
<jsp:include page="Register.html" ></jsp:include>
<%
 }
 }catch(Exception e){out.println(e);}
 %>
</body></html>
